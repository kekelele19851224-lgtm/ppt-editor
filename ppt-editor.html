<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>PPT编辑器</title>
<style>
html,body{width:100%;height:100%}
#app{width:100%;height:100%;position:fixed;top:0;left:0}
.topbar{position:fixed;top:0;left:0;right:0;height:44px;display:flex;align-items:center;justify-content:space-between;background:#111;color:#fff;z-index:10;padding:0 12px}
.btn{display:inline-flex;align-items:center;justify-content:center;height:30px;padding:0 12px;border-radius:6px;background:#2b2b2b;color:#fff}
.content{position:absolute;top:44px;left:0;right:0;bottom:0}
.iframe{border:0;width:100%;height:100%}
</style>
</head>
<body>
<div class="topbar">
<div id="title">Docmee PPT</div>
<div id="back" class="btn">返回小程序</div>
</div>
<div class="content">
<div id="app"></div>
</div>
<script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
<script src="https://docmee.cn/sdk/docmee-ui.umd.js"></script>
<script>
function q(){var p={},s=location.search.slice(1).split('&');for(var i=0;i<s.length;i++){if(!s[i])continue;var t=s[i].split('=');p[decodeURIComponent(t[0])]=decodeURIComponent(t[1]||'')}return p}
var params=q();
var token=params.token||'';
var subject=params.subject||'';
var templateId=params.templateId||'';
var pptId=params.pptId||'';
var mode=params.mode||'create';
document.getElementById('title').innerText=mode==='edit'?'编辑PPT':'生成PPT';
document.getElementById('back').onclick=function(){if(window.wx&&wx.miniProgram&&wx.miniProgram.navigateBack){wx.miniProgram.navigateBack()}else{history.back()}};
var mount=document.getElementById('app');
if(typeof DocmeeUI!=='undefined'){
var ui=new DocmeeUI({container:'app',token:token});
if(mode==='edit'&&pptId){ui.open&&ui.open({id:pptId})}
else{ui.generate&&ui.generate({subject:subject,templateId:templateId})}
}else{
var url='https://docmee.cn/open-platform/ui-sdk?token='+encodeURIComponent(token)+(mode==='edit'?'&pptId='+encodeURIComponent(pptId)+'&mode=edit':'&subject='+encodeURIComponent(subject)+'&templateId='+encodeURIComponent(templateId)+'&mode=create');
var ifr=document.createElement('iframe');
ifr.className='iframe';
ifr.src=url;
mount.appendChild(ifr);
}
window.addEventListener('message',function(e){var data=e&&e.data?e.data:{};if(!data)return;});
</script>
</body>
</html>
