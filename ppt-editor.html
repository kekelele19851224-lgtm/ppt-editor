<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>测试 Type 7</title>
  <script src="./docmee-ui-sdk-iframe.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; }
    #ppt-container { width: 100%; height: 100%; }
  </style>
</head>
<body>
  <div id="ppt-container"></div>

  <script>
    // TODO: 填入你的 token
    var token = 'sk_FMGz7I5FsT5rEqqArk';
    
    var testOutline = `# 心理健康教育

## 1 认识心理健康
### 1.1 心理健康的定义
### 1.2 心理健康的重要性

## 2 常见心理问题
### 2.1 压力与情绪管理
### 2.2 焦虑和抑郁

## 3 维护心理健康
### 3.1 情绪管理技巧
### 3.2 寻求专业帮助
`;

    console.log('Token:', token ? '已设置' : '未设置');
    console.log('大纲长度:', testOutline.length);

    if (typeof DocmeeUI !== 'undefined' && token) {
      var docmeeUI = new DocmeeUI({
        token: token,
        container: document.querySelector('#ppt-container'),
        page: 'creator',
        creatorVersion: 'v2',
        lang: 'zh',
        mode: 'light',
        isMobile: false,
        creatorData: {
          type: 7,
          content: testOutline
        },
        onMessage: function(message) {
          console.log('DocmeeUI 事件:', message.type, message);
        }
      });
      console.log('初始化成功，观察页面显示的是「选择模板」还是「输入主题」');
    } else {
      document.getElementById('ppt-container').innerHTML = '<div style="padding:20px;">SDK加载失败或token未设置</div>';
    }
  </script>
</body>
</html>
